![image](https://github.com/user-attachments/assets/87dabf3a-a42b-42f8-a70f-cee561aed983)## 실행 컨텍스트
<b>실행 코드에 제공할 환경 정보들을 모아놓은 객체</b> <br>
자바스크립트는 실행 컨텍스트가 활성화되는 시점에 선언된 변수를 위로 끌어올리고, 외부 환경 정보를 구성하고, this 값을 설정하는 등의 동작을 수행한다.

## 01. 실행 컨텍스트란?
- 실행 컨텍스트 : 실행할 코드에 제공할 환경 정보들을 모아놓은 객체
- 전체 코드의 환경과 순서를 보장한다.
  1. 동일한 환경에 있는 코드들을 실행할 때 필요한 환경 정보들을 모아 컨텍스트를 구성하고
  2. 이를 콜 스택에 쌓았다가
  3. 가장 위에 있는 컨텍스트와 관련 있는 코드를 실행한다.
  - 동일한 환경을 구성하는 방법
    - 전역 공간 (자동 생성)
    - [eval() 함수](https://www.youtube.com/shorts/mgdCHjJjR4M) (사용 지양)
    - 함수 실행

- 함수 실행 시의 실행 컨텍스트와 콜 스택
```
---------------------(1)
var a = 1; 
function outer() {
    function inner() {
        console.log(a); // undefined
        var a = 3;
    }
    inner(); // -------- (2)
    console.log(a); // 1
}
outer(); // ------------- (3)
console.log(a); // 1
```
![image](https://github.com/user-attachments/assets/0b1ba9fd-c955-4c70-aebb-1ffcae836416)
(1) 처음 자바스크립트 코드를 실행하는 순간 전역 컨텍스트가 콜 스택에 담긴다. <br>
코드 순차 진행 <br>
(3) 에서 outer 함수 호출하면 outer에 대한 환경 정보를 수집해서 outer 실행 컨텍스트를 생성한 후 콜 스택에 담는다. <br>
전역 컨텍스트와 관련된 코드의 실행은 일시중단되고 outer 실행 컨텍스트와 관련된 코드가 실행된다. <br>
(2) 에서 inner 함수의 실행 컨텍스트가 콜 스택의 위에 담기면 outer 관련 코드의 실행이 멈추고 inner 함수 내부의 코드를 순서대로 진행한다. <br>
inner 함수의 실행이 종료되면서 inner 실행 컨텍스트가 콜 스택에서 제거된다. <br>
(2) 의 다음 줄부터 이어서 실행된다.<br>
(3) 의 다음 줄부터 이어서 실행된다. <br>
전역 공간에 실행할 코드가 남아있지 않으므로, 전역 컨텍스트도 제거된다. <br>
콜 스택에 아무것도 남지 않은 상태로 종료된다. <br>

- 전역 컨텍스트 : 최상단의 공간은 별도의 실행 명령이 없어도 브라우저에서 자동으로 실행하므로 자바스크립트 파일이 열리는 순간 전역 컨텍스트가 활성화 된다.

#### 이렇게 생성된 실행 컨텍스트 객체는 자바스크립트 엔진이 활용할 목적으로 생성할 뿐 개발자는 확인 할 수 없다.
담기는 정보
- Variable Environment : 현재 컨텍스트 내의 식별자들에 대한 정 보 + 외부 환경 정보, 선언 시점의 렉시컬 환경의 스냅샷으로 변경 사항은 반영되지 않는다. 
- LexicalEnvirionment : 처음에는 변수 환경과 같지만 변경 사항이 실시간으로 반영된다.
- ThisBinding : this 식별자가 바라봐야 할 대상 객체
![image](https://github.com/user-attachments/assets/a04cf13b-ba31-4df5-bbce-51b4b7988cf1)

## 02. VariableEnvironment
- 렉시컬 환경과 같은 내용을 담지만, <b>최초 실행 시의 스냅샷을 유지한다.</b>
- 실행 컨텍스트를 생성할 때 변수 환경에 정보를 먼저 담은 다음에 이것을 복사해서 렉시컬 환경을 만들기 때문에
- 내부에는 environmentRecord와 outer-EnvironmentReference로 구성된다.

## 03. LexicalEnvironment
- 사전과 비슷한 느낌 (현재 컨텍스트의 내부에는 a, b, c와 같은 식별자들이 있고 그 외부 정보는 D를 참조하도록 구성돼있다. 와 같은 느낌으로 모아놓은 것)

### 03-01. environmentRecord와 호이스팅
![image](https://github.com/user-attachments/assets/1276eb21-70a8-4ede-a9af-97dbbbf92a73)
- 현재 컨텍스트와 관련된 코드의 식별자 정보들이 저장된다.
- 컨텍스트 내부 전체를 훑어나가며 매개수의 이름, 함수 선언, var로 선언된 변수의 식별자 등을 순서대로 수집한다.
- 코드의 실행 전에 변수 정보를 수집한다. -> 런타임 이전에 자바스크립트 엔진은 이미 해당 환경에 속한 코드의 변수명들을 모두 알고 있다 (호이스팅 참조)
- 어떤 식별자들이 있는지에만 관심이 있고, 각 식별자에 어떤 값이 할당될 것인지는 관심이 없다.
- 변수는 선언부만 끌어올리지만
- 함수 선언은 함수 전체를 끌어올린다.
- 호이스팅이 끝난 상태에서의 함수 선언문은 함수명으로 선언한 변수에 함수를 할당한 것 처럼 여길 수 있다.
- 함수 표현식도 마찬가지로 변수의 선언부만 끌어올리고 변수의 할당부는 끌어올려지지않는다.
- 전역공간에 동명의 함수가 여럿 존재하는 상황이라 하더라도 모든 함수가 함수 표현식으로 정의돼 있었다면 문제가 발생하지 않을 수 있다.

### 03-02. 스코프, 스코프 체인, outerEnvironmentReference
스코프 : 식별자에 대한 유효범위 <br>
스코프 체인 : 식별자의 유효범위를 안에서 부터 바깥으로 차례로 검색해나가는 것 <br>
outerEnvironmentReferenct : 스코프 체인 검색을 가능하게 하는 렉시컬 환경의 수집 자료 <br>

#### 스코프 체인
outerEnvironmentReferenct는 현재 호출된 함수가 선언될 당시의 렉시컬 환경을 참조한다. <br>
ex) A 함수 내부에 B 함수를 선언하고 다시 B 함수 내부에 C 함수를 선언한 경우, <br>
C의 outerEnvironmentReference는 B의 렉시컬 환경을 참조한다. <br>
B의 outerEnvironmentReference는 A의 렉시컬 환경을 참조한다. <br>
이처럼 연결리스트를 outerEnvironmentReference는 띈다. <br>
이렇게 계속 찾아올라가면 마지막엔 전역 컨텍스트의 렉시컬 환경이 있다.
- 여러 스코프에서 동일한 식별자를 선언한 경우에는 무조건 스코프 체인 상에서 가장 먼저 발견된 식별자에만 접근 가능하다.
- 변수 은닉화 : a를 전역 공간에서도 선언하고 inner 함수 내부에서도 선언한 경우, inner 함수 내부에서는 전역 공간에서 선언한 a 변수에는 접근할 수 없다.

## 04. this
-thisBinding에는 this로 지정된 객체가 저장된다.
